<html>
	<head>
		<title>Clotho WebSocket Example</title>
		<script type='text/javascript'>
			if (!window.WebSocket)
				alert("WebSocket not supported by this browser");
		
			function $() {
				return document.getElementById(arguments[0]);
			}
			function $F() {
				return document.getElementById(arguments[0]).value;
			}
		
			function getKeyCode(ev) {
				if (window.event)
					return window.event.keyCode;
				return ev.keyCode;
			}
		
			var server = {
				connect : function() {

					//var location = "ws://localhost:61623";
					var location = "ws://localhost:8080/websocket/";

					this._ws = new WebSocket(location);
					this._ws.onopen = this._onopen;
					this._ws.onmessage = this._onmessage;
					this._ws.onclose = this._onclose;
				},
		
				_onopen : function() {
				},
		
				_send : function(channel, action, text) {
					if (this._ws) {
				        
						var message = 
							{ channel: channel, action: action, data: { message: text } };
						
						this._ws.send(
								JSON.stringify(message));
					}
				},
		
				send : function(channel, action, message) {
					server._send(channel, action, message);
				},
		
				_onmessage : function(m) {
					if (m.data) {
						//alert(m.data);
					}
				},
		
				_onclose : function(m) {
					this._ws = null;
				}
			};
		</script>
		<style type='text/css'>
			div {
				border: 0px solid black;
			}
			
			div#input {
				clear: both;
				width: 40em;
				padding: 4px;
				background-color: #e0e0e0;
				border: 1px solid black;
				border-top: 1px
			}
			
			div.hidden {
				display: none;
			}
			
			span.alert {
				font-style: italic;
			}
		</style>
	</head>
	<body>
	    <script type="text/javascript">
		server.connect();
	    </script>
	    
		<div id='input'>
			<div>
			    Channel: 
			    <select id='channel'>
  					<option value="EXECUTION">EXECUTION</option>
  					<option value="AUTOCOMPLETION">AUTOCOMPLETION</option>
					<option value="NOTIFICATION">NOTIFICATION</option>
					<option value="ACCESS">ACCESS</option>
				</select>

				&nbsp;
				
				Action:
			    <select id='action'>
  					<option value="LOGIN">LOGIN</option>
  					<option value="LOGOUT">LOGOUT</option>
					<option value="GET">GET</option>
					<option value="SET">SET</option>
					<option value="REMOVE">REMOVE</option>
					<option value="RUN">RUN</option>
					<option value="SHOW">SHOW</option>
				</select>

				&nbsp;
				
			    <input id='message' class='text'></input>
				<input id='send' class='button' type='submit' name='Send'
					value='Send' />
			</div>
		</div>
		<script type='text/javascript'>
			$('send').onclick = function(event) {
				server.send($('channel').value, $('action').value, $('message').value);
			};
		</script>
 
	</body>
</html>