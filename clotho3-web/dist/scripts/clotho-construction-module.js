angular.module("clotho.construction",["clotho.foundation","clotho.dna"]),angular.module("clotho.construction").value("ConstructionReactions",{pcr:{reaction:"",clientReaction:"PCR.predict",readable:"PCR",template:"views/_construction/step/pcr.html"},ligate:{reaction:"",clientReaction:"PCR.ligate",readable:"Ligation",template:"views/_construction/step/ligate.html"},digest:{reaction:"",clientReaction:"Digest.digest",readable:"Restriction Digest",template:"views/_construction/step/digest.html"},gelpurify:{reaction:"",clientReaction:"Digest.gelPurify",readable:"Gel Purify",template:"views/_construction/step/gelpurify.html"}}),angular.module("clotho.construction").service("ConstructionSimulator",["ConstructionReactions","$q","Debug","Clotho",function(a,b,c,d){var e=(new c("ConstructionSimulator","#88bb88"),function(a){var b="final",c=_.assign({dictionary:{}},a);if(_.isEmpty(c.steps))return c;_.forEach(c.steps,function(a){_.forEach(a.input,function(){})});var d=_.last(c.steps).output;return d!=b&&(c.dictionary[b]=c.dictionary[d]),c});return{process:e}}]),angular.module("clotho.construction").directive("constructionFile",["ConstructionSimulator",function(a){return{restrict:"A",templateUrl:"views/_construction/constructionFile.html",scope:{file:"=constructionFile"},link:function(b){b.$watch("file",function(c){b.computed=a.process(c)})}}}]),angular.module("clotho.construction").directive("constructionStep",["ConstructionReactions","$parse",function(a,b){return{restrict:"A",templateUrl:"views/_construction/constructionStep.html",link:function(c,d,e){c.$watch(function(){return b(e.constructionStep)(c)},function(b){angular.isNumber(b)&&(c.step=c.file.steps[b],c.reaction=a[c.step.reaction])})}}}]),angular.module("clotho.construction").directive("constructionStepInner",["$http","$compile","ConstructionReactions",function(a,b,c){return{restrict:"A",link:function(d,e,f){d.$watch(function(){return f.constructionStepInner},function(f){if(f){var g=c[f];!angular.isEmpty(g)&&a.get(g.template,{cache:!0}).then(function(a){e.html(b(a.data)(d))})}})}}}]);