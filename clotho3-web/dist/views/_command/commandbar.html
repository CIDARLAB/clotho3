<nav id="clotho_commandBar" role="navigation">

    <clotho-modal open="showClothoLoginModal" title="Clotho Login">
        <div ng-include="'views/_command/simpleLogin.html'"></div>
    </clotho-modal>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div id="clotho_commandBarWrapper">

        <!--input-->
        <div id="clotho_command_inputWrapper">
            <!--todo - add these attributes via directive -->
            <input id="clotho_command_input" name="searchBar" type="text" placeholder="Enter Command or Search Term" autocorrect="off" autocapitalize="off" spellcheck="false" autocomplete="off" ng-model="display.query" ui-keypress="{'enter':'submit(display.query)'}" ui-keydown="{'down':'selectAutoNext($event)','up':'selectAutoPrev($event)','esc':'display.hide(\'autocomplete\'); display.undetail()'}">
            <span id="clotho_command_submitWrapper">
                <button type="button" id="clotho_command_submit" ng-click="submit(display.query)">Submit</button>
            </span>
        </div>

        <!--autocomplete -->
        <!--todo - use directive-->
        <div id="clotho_command_autocomplete" ng-show="display.autocomplete" click-outside="display.hide('autocomplete'); display.undetail();" ng-init="display.genAutocompletePos()" click-outside-active="display.autocomplete" ng-style="display.autocompletePos">
            <ul id="clotho_command_autocompleteList">
                <a id="clotho_command_autocompleteListClose" ng-click="display.hide('autocomplete'); display.undetail()">&times;</a>
                <!--| filter:{text:display.query}-->
                <li ng-repeat="item in (filtered = (autocomplete.autocompletions)) | limitTo:10" ng-class="{'disabled': item.type == 'phrase'}">
                    <a class="clotho_command_autocompleteItem" ng-click="setQuery(item, $event)" ng-mouseenter="display.detail(item.uuid)" >{{item.text}}</a>
                </li>

                <li ng-if="!filtered.length" class="disabled"><a><i class="glyphicon glyphicon-exclamation-sign"></i> No results...</a></li>
            </ul>
            <!-- todo - major rewrite of detail -->
            <div id="clotho_command_autcompleteDetail" ng-show="display.autocompleteDetail" ng-cloak>
                <div class="popover-content">
                    <a class="close" ng-click="display.undetail()" style="position: absolute; top: 0; right: 5px;">&times;</a>
                    <div style="margin-bottom: 10px;">
                        <button class="pull-right btn btn-primary top" ng-click="execute(autocomplete.autoDetail.command_object)">Execute</button>
                        <h4 style="margin: 5px 0;">{{autocomplete.autoDetail.text}}</h4>
                        <code><small>{{autocomplete.autoDetail.command_native}}</small></code>
                    </div>
                    <table class="table table-bordered" id="clothoSearchbarAutocompleteDetailVersions">
                        <tr ng-repeat="item in autocomplete.autoDetail.sharables | limitTo:3">
                            <td style="cursor: pointer" ng-class="{'info': item === autocomplete.detailModel}" ng-click="display.detailInfo('command', $index)">{{item.text}}</td>
                            <td style="cursor: pointer" ng-class="{'info': item.author === autocomplete.detailModel}" ng-click="display.detailInfo('author', $index)">{{item.author.name}}</td>
                        </tr>
                    </table>
                    <div ng-if="display.autocompleteDetailInfo" ng-include="autocomplete.detailTemplate" ng-model="autocomplete.detailModel">
                    </div>
                </div>
            </div>
        </div>


        <!--log-->
        <div id="clotho_logButtonContainer" ng-init="display.genLogPos()" click-outside="display.hide('log');" click-outside-active="display.log">
            <button id="clotho_logButton" ng-click="display.toggle('log'); log.unread = 0">
                <i class="glyphicon glyphicon-tasks" style="top: 3px;"></i>
                <span class="badge badge-info" ng-if="log.unread > 0">{{ log.unread }}</span>
            </button>

            <div id="clotho_log" ng-show="display.log" ng-style="display.logpos" >
                <div class="arrow"></div>
                <h3 class="popover-title">
                    Activity Log

                    <button class="btn btn-warning dropdown-toggle pull-right" ng-click="display.log = false" style="margin-top: -6px">
                        <i class="glyphicon glyphicon-remove"></i>
                    </button>
                    <button class="btn dropdown-toggle pull-right" ng-click="fullPageLog()" ng-disabled="pathIsTerminal()" style="margin-top: -6px">
                        <i class="glyphicon glyphicon-fullscreen"></i>
                    </button>

                </h3>

                <div id="clotho_logEntries">
                    <div log-entries="log.entries"></div>
                </div>
            </div>
        </div>


        <!--log snippet-->
        <div id="clotho_logSnippet" class="alert alert-{{log.entries[0].class}}" ng-show="display.logSnippet" ng-mouseenter="log.cancelLogTimeout()" ng-mouseleave="log.startLogTimeout()">
            <small>{{log.entries[0].text}}</small>
        </div>


        <!--help buttons-->
        <div class="btn-group nav navbar-right">
            <button class="btn btn-default" ng-click="showLogin()" alt="Clotho Login"><i class="glyphicon glyphicon-user"></i></button>
            <button class="btn btn-default" ng-click="goHome()"><i class="glyphicon glyphicon-home"></i></button>
            <a class="btn btn-default dropdown-toggle" ng-click="showHelpDropdown = !showHelpDropdown" style="padding-left: 12px; padding-right: 12px;" id="commandbar_helpbutton"><i class="glyphicon glyphicon-question-sign"></i></a>
            <ul class="dropdown-menu" ng-style="{'display' : showHelpDropdown ? 'block' : 'none'}">
                <li><a ng-click="showMeHow()" tabindex="-1"><i class="glyphicon glyphicon-eye-open"></i> Show me how</a></li>
                <li><a ng-click="aboutClotho()" tabindex="-1"><i class="clotho-icon"></i> About Clotho</a></li>
                <li><a ng-click="teamClotho()" tabindex="-1"><i class="glyphicon glyphicon-user"></i> The Clotho Team</a></li>
            </ul>
        </div>

    </div>
</nav>