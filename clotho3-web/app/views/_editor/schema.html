<div ng-controller="Editor_SchemaCtrl">

    <legend>Schema Editor</legend>

    <div class="ng-cloak">

        <div class="control-group">
            <label class="control-label" for="schemaName">Name</label>
            <div class="controls">
                <input type="text" id="schemaName" ng-model="sharable.name" ng-disabled="!editMode" required restrict-input="findSpacesRegExp">
            </div>
        </div>

        <div class="control-group">
            <label class="control-label" for="superClass">Parent</label>
            <div class="controls">
                <select id="superClass" ng-model="sharable.superClass" ng-options="schema.id as schema.name for schema in schemas" ng-disabled="!editMode">
                    <option value="">-</option>
                </select>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label" for="schemaDesc">Description</label>
            <div class="controls">
                <textarea type="text" id="schemaDesc" class="input-large" ng-model="sharable.description" style="width: 100%; height: 3em" ng-disabled="!editMode"></textarea>
            </div>
        </div>

        <h4>
            Methods
        </h4>
        <div class="input-append">
            <input type="text" id="newMethodText" ng-model="newMethodObj" ng-init="newMethodObj = newMethod()" ng-disabled="!editMode" typeahead="opt.id as opt.name for opt in clothoFunctions | filter:$viewValue" typeahead-min-length="0"/>
            <button class="btn pull-right" type="button" ng-click="addNewMethod()" ng-disabled="!editMode || !newMethodObj"><i class="icon-plus"></i></button>
        </div>

        <h3>
            Fields
        </h3>

        <div ng-if="sharable.superClass">
            <h4>Inherited Fields</h4>

            <div ng-repeat="field in superClassObj.fields">
                <div class="row-fluid">
                    <input type="text" ng-model="field.type" class="span3" disabled />
                    <input class="span6" type="text" ng-model="field.name" disabled />
                    <input type="text" ng-model="field.access" class="span3" disabled />
                </div>
            </div>

            <h4>This Object's fields</h4>

        </div>

        <div ng-repeat="field in sharable.fields">
            <div class="row-fluid">
                <select ng-model="field.type" class="span3" ng-disabled="!editMode" ng-options="t.name as t.name group by t.category for t in paramTypes" ng-change="parseField(field)" required>
                    <option value="" disabled>Type</option>
                </select>
                <input class="span6" type="text" ng-model="field.name" ng-disabled="!editMode" placeholder="Field Name (no spaces)" restrict-input="findSpacesRegExp" required>
                <select ng-model="field.access" class="span3" ng-disabled="!editMode" ng-options="t.value as t.name for t in accessTypes">
                    <option value="" disabled>Access</option>
                </select>
            </div>
            <div class="row-fluid clearfix">
                <div class="span6 pull-left">
                    <input class="span12" type="text" ng-model="field.description" ng-disabled="!editMode" placeholder="Field Description">
                    <input ng-if="!field.reference" class="span12" type="text" ng-model="field.example" ng-disabled="!editMode" placeholder="Field Example">
                    <input ng-if="field.reference" class="span12" type="text" ng-model="field.example" ng-disabled="!editMode" placeholder="Field Example" typeahead="opt for opt in querySchemaWrapper(field.type) | filter:$viewValue" typeahead-min-length="0" />
                </div>
                <div class="span6 pull-right">
                    <div ng-show="!!field.constraints">
                        <h5>
                            Constraints
                            <button class="btn pull-right" type="button" ng-click="addConstraint($index)" ng-disabled="!editMode"><i class="icon-plus"></i></button>
                        </h5>
                        <div ng-repeat="constraint in field.constraints" class="row-fluid">
                            <select ng-model="constraint.type" class="span4" ng-disabled="!editMode" ng-options="t.value as t.name for t in constraintTypes"></select>
                            <input class="span8" type="text" ng-model="constraint.value" ng-disabled="!editMode" placeholder="Constraint Value">
                        </div>
                    </div>
                    <div ng-hide="!!field.constraints">
                        <button class="btn pull-right" type="button" ng-click="addConstraint($index)" ng-disabled="!editMode"><i class="icon-plus"></i>Add Constraint</button>
                    </div>

                </div>
            </div>
            <hr />
        </div>

        <button class="btn" type="button" ng-click="addField()" ng-disabled="!editMode"><i class="icon-plus"></i> New Field</button>


        <div ng-include="_formActions"></div>


        {{ sharable | json }}


    </div>
</div>